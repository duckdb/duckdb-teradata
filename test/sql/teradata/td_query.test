require teradata

# Pass teradata logon string as environment variable
# e.g. 'export TD_LOGON="127.0.0.1/dbc,dbc"`
require-env TD_LOGON

# Pass database name to use when creating test tables
# e.g. 'export TD_DB="duckdb_testdb"'
require-env TD_DB

# Attach teradata database
statement ok
attach '${TD_LOGON}' as td (TYPE TERADATA, DATABASE '${TD_DB}');

# Select with the teradata_query function
query I
select * from teradata_query('td', 'select 1 + 2');
----
3

# Use the table macro created in the schema
query I
select * from td.query('select 1 + 2');
----
3
