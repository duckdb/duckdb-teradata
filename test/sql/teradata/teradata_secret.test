require teradata

# Pass teradata logon string as environment variable
# e.g. 'export TD_LOGON="127.0.0.1/dbc,dbc"`
require-env TD_LOGON

# Pass database name to use when creating test tables
# e.g. 'export TD_DB="duckdb_testdb"'
require-env TD_DB

# Should not work
statement error
ATTACH '' as td (TYPE TERADATA)
----
Invalid Input Error: Teradata ATTACH must contain a 'user', either in the logon string, passed as options or in defined in a secret

statement error
ATTACH '' as td (TYPE TERADATA, SECRET my_secret)
----
Invalid Input Error: No Teradata secret found with name: my_secret

statement error
CREATE SECRET my_secret (
	TYPE TERADATA,
	HOST '127.0.0.1',
	DATABASE '${TD_DB}',
	PASSWORD 'dbc'
);
----
Invalid Input Error: Teradata secret must contain 'HOST', 'USER', 'DATABASE', and 'PASSWORD' parameters

statement ok
CREATE SECRET my_secret (
	TYPE TERADATA,
	HOST '127.0.0.1',
	DATABASE '${TD_DB}',
	USER 'dbc',
	PASSWORD 'dbc'
);

# Should work
statement ok
ATTACH '' as td (TYPE TERADATA, SECRET my_secret)